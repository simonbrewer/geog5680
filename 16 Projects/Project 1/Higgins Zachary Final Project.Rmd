---
title: "Final Project"
author: "Zachary Higgins"
date: "6/16/2020"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## Introduction


to complete an analysis on this homprice data I have used the following packages
```{r}
library(ggplot2)
library(ggpubr)
library(dplyr)
library(gridExtra)
library(tidyr)
```
now read in the data on home prices
```{r}
hp=read.csv("homeprice.csv")
head(hp)
```
each plot here is a diferent X variable with Y as sale price
```{r}
p1=ggplot(hp, aes(y=sale)) + ylab("Sale Price")+ geom_point()+
  aes(x=list) + xlab("List Price")+geom_abline()+stat_cor(col="blue")
p2=ggplot(hp, aes(y=sale)) + ylab("Sale Price")+ geom_point()+
  aes(x=full) + xlab("# of Full Baths")+geom_abline()+stat_cor(col="blue")
p3=ggplot(hp, aes(y=sale)) + ylab("Sale Price")+ geom_point()+
  aes(x=half) + xlab("# of Half Baths")+geom_abline()+stat_cor(col="blue")
p4=ggplot(hp, aes(y=sale)) + ylab("Sale Price")+ geom_point()+
  aes(x=bedrooms) + xlab("# of Bedrooms")+geom_abline()+stat_cor(col="blue")
p5=ggplot(hp, aes(y=sale)) + ylab("Sale Price")+ geom_point()+
  aes(x=rooms) + xlab("# of Rooms")+geom_abline()+stat_cor(col="blue")
p6=ggplot(hp, aes(y=sale)) + ylab("Sale Price")+ geom_point()+
  aes(x=neighborhood) + xlab("Neighborhood Rank (1: poor; 5: rich)")+geom_abline()+stat_cor(col="blue")
```

```{r}
p1=ggplot(hp, aes(y=sale)) + ylab("Sale Price")+ geom_point()+
  aes(x=list) + xlab("List Price")+geom_smooth(method = "lm")+stat_cor(col="blue")
p2=ggplot(hp, aes(y=sale)) + ylab("Sale Price")+ geom_point()+
  aes(x=full) + xlab("# of Full Baths")+geom_smooth(method = "lm")+stat_cor(col="blue")
p3=ggplot(hp, aes(y=sale)) + ylab("Sale Price")+ geom_point()+
  aes(x=half) + xlab("# of Half Baths")+geom_abline()+stat_cor(col="blue")
p4=ggplot(hp, aes(y=sale)) + ylab("Sale Price")+ geom_point()+
  aes(x=bedrooms) + xlab("# of Bedrooms")+geom_abline()+stat_cor(col="blue")
p5=ggplot(hp, aes(y=sale)) + ylab("Sale Price")+ geom_point()+
  aes(x=rooms) + xlab("# of Rooms")+geom_abline()+stat_cor(col="blue")
p6=ggplot(hp, aes(y=sale)) + ylab("Sale Price")+ geom_point()+
  aes(x=neighborhood) + xlab("Neighborhood Rank (1: poor; 5: rich)")+geom_abline()+stat_cor(col="blue")
```
Plots of Sale Price Against Various x values
```{r}
# ggarrange(p1,p2,p3,p4,p5,p6, dev.new(width=8,height=4,unit="in"))
fig <- ggarrange(p1,p2,p3,p4,p5,p6)
annotate_figure(fig, top = text_grob("Title here", face = "bold", size = 14))
```

accepting values at 0.001 signifigance level for model, they are in order listprice,neighborhoodrank,#rooms,#fullbaths,
  lm of sig vars on sale price
```{r}
lm1=lm(hp$sale~hp$list+hp$neighborhood+hp$rooms+hp$full)
summary(lm1)
anova(lm1)
```
lm vars on list price
```{r}
lm2=lm(hp$list~hp$sale+hp$neighborhood+hp$rooms+hp$full)
summary(lm2)
anova(lm2)
```
here we look into how neighborhood rank effects the difference between list and sale price
```{r}
data_long = gather(hp, pricetype, price, list:sale, factor_key=TRUE)

hoodprice= select(data_long, pricetype, price, neighborhood)

as.character(hoodprice$pricetype)

p7=ggboxplot(hoodprice, x="neighborhood", y="price", col = "pricetype", xlab = "Neighborhood Rank", ylab = "Price")
p7
```
now to look at if the effect of neighborhood rank on list-sale price is significant
```{r}
lm3=lm((hp$list-hp$sale)~hp$neighborhood)
summary(lm3)
anova(lm3)
```

```{r}
hp$pricediff = hp$list - hp$sale
hp$neighborhood = as.factor(hp$neighborhood)
lm(pricediff ~ neighborhood, hp)

```